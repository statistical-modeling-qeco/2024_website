<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Random variables and probability distributions</title>
    <meta charset="utf-8" />
    <meta name="author" content="PI (Paulo InÃ¡cio Prado)" />
    <meta name="date" content="2024-01-29" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <script src="libs/xaringanExtra_fit-screen/fit-screen.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy code <i class=\"fa fa-clipboard\"><\/i>","success":"Copied! <i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"Not copied ðŸ˜• <i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
    <link href="libs/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Random variables and probability distributions
]
.subtitle[
## Quantitative Ecology Training Program - Serrapilheira
]
.author[
### PI (Paulo InÃ¡cio Prado)
]
.date[
### 29 January 2024
]

---






## Key concepts

+ Random variables

+ Probability density functions

+ Probability distributions as statistical models

+ The normal probability distribution

+ Fitting statistical models to data

+ Other probability distributions

---

## Empirical data


.pull-left[

* Collection of *Drosophila melanogaster* populations 18 sites in Australia.
* Isofemale lines : progeny of single collected females allowed
  to interbreed 10 generations in the lab.
* 50 larvae from lines from each population kept at
  18Â°C, 25Â°C, and 29Â°C to develop (3 replicates).
* Controlled lab conditions: vials, culture medium, light cycle,
  temperature, fly density, etc.
* Measurement of adult flies reared from the vials.

]

.pull-right[
.center[

![](drosophila_culture.png)
]

.right[

Van Heerwaarden &amp; SgrÃ², *Evolution* (2011).]

]

---

## Empirical data




.pull-left[

* 30 adults picked at random among flies reared at
  each temperature.
* The histograms show frequencies of flies in classes of thorax length
for each population, only for females reared at 25Â°C.
* Blue lines are thorax length means from each sample.
]


.pull-right[
.center[

![](slides_files/figure-html/drosophila pops histogram-1.png)&lt;!-- --&gt;
]
]

---

## Distribution of sample means

.pull-left[
.center[

![](slides_files/figure-html/unnamed-chunk-1-1.png)&lt;!-- --&gt;
]
]

.pull-right[
.center[


![](slides_files/figure-html/drosophila-mean-hist-1.png)&lt;!-- --&gt;

]]


---


## Random variables

.pull-left[

* Many values are possible, even for averages of measurements taken
  exactly in the same way, and under strongly controlled conditions.

* Scientific measurements are **random variables**: quantities that
  are inevitably affected by random events.

* How to deal with that? With models that tell us what's the chance of
observing each possible value of the measurement.

* In other words, by building **probability distributions**.

]

.pull-right[
.center[


![](slides_files/figure-html/unnamed-chunk-2-1.png)&lt;!-- --&gt;

]]

---

## 1st step: the density scale

.pull-left[


* Let's re-scale the y-axis of this histogram, to make the total area
  of the histogram equal to one.
* That is, we express the original frequencies (or counts) in a new
  scale, such that the sum of the area of the bars is equal to one. We
  cal this scale **density**
* This is a linear (a.k.a. proportional) re-scaling, so the shape of the
  histogram does not change.

]

.pull-right[
.center[


![](slides_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;

]]

---

## 2nd step: the density function

.pull-left[

* Now let's imagine how to "smooth" the distribution of densities,
  using a continuous function.
* Think on this function as a continuous counterpart (or a continuous
  limit) of the histogram. This is the **density function**
* The area under the curve of a density function is one.

]


.pull-right[
.center[


![](slides_files/figure-html/unnamed-chunk-4-1.png)&lt;!-- --&gt;

]]


---


## Density function: some definitions

.pull-left[

* The density function is a continuous mathematical function `\(f(x)\)` that returns a density
  value for any value of the measurement `\(x\)`.
* We call the **sample space** ( `\(\Omega\)` ) the set of all values that a
  random variable can assume.


]


.pull-right[
.center[


![](slides_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;

]]


---

## Density function and probabilities

.pull-left[


* The integral of `\(f(x)\)` over the sample space equals one.

* This is a mathematical way to say that the area under `\(f(x)\)` equals one.

]

.pull-right[
.center[
![](slides_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;
]]

---

## Density function and probabilities

.pull-left[


* The area under `\(f(x)\)` for any interval `\(L \leq x \leq U\)` is a
  fraction of the total area under `\(f(x)\)`.

* This area is a mathematical expression of the **probability assigned
  to a measurement interval**. It is also an integral of the density
  function:

$$ P(L \leq x \leq U) ~ = ~ \int_L^U f(x) \, dx $$

]

.pull-right[
.center[
![](slides_files/figure-html/unnamed-chunk-7-1.png)&lt;!-- --&gt;
]]

---


## Probability distributions as models


* The density function that we have defined is used to express
  probabilities of random variables, or a **probability
  distribution**.

--

* It is a model that attributes probabilities to data, that is, to
  values of a random variable.

--

* In our example, the random variable is the mean thorax length that
  we got from samples of 30 flies.

--

* With this kind of model we can ask many interesting questions about
  these sample means, like:


---

class: center, middle

### What's the probability of a mean thorax length of up 1.04 mm?

![](slides_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;

---

class: center, middle

### What's the confidence interval for the mean thorax length?

![](slides_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;


---

class: center, middle

### What's the theoretical expected value for this distribution?


![](slides_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;

---

## Which probability distribution ?


* Now we know that probability distributions are a nice choice to
  model random variables. But how to build such a model?

--

* There are recipes to do that, but many probability distributions
  have been already proposed, for a huge variety of data types.

--

* In our example, our random variable are sample means. The **Central
  Limit Theorem** states that sample means will follow a Normal
  distribution, as the size of the samples increase.
  
--

* This is one of the most important results in probability theory. We
  have very good reasons to choose a Normal distribution as our
  statistical model.

---

## The Normal Distribution

.pull-left[

* Created to describe distribution of additive measurement errors.
* CLT tells us that this is good model for any random variable which is
a sum of many other random variables.
* It is a symmetric distribution, always bell-shaped.
* It has two parameters, that correspond to the mean and standard
  deviation of the distribution.
* Its mean and standard deviation  are independent.
]

.pull-right[
.center[

![](slides_files/figure-html/normal-curve-1.png)&lt;!-- --&gt;

]]

---


## Location parameter of the Normal Distribution


.pull-left[

* The Normal has a **location parameter**, that we will call `\(\mu\)`.
* This parameter corresponds to the mean of the Normal distribution.
* By changing `\(\mu\)` we change the position of the Normal distribution
along the x axis, without changing the standard deviation.
]

.pull-right[
.center[
	![](slides_files/figure-html/normal-location-1.png)&lt;!-- --&gt;
]
]

---

## Scale parameter of the Normal Distribution

.pull-left[

* The Normal has a **scale parameter**, that we will call `\(\sigma\)`.
* This parameter corresponds to the standard deviation of the Normal distribution.
* By changing `\(\sigma\)` we change the spread of the Normal distribution
around the mean, without changing the mean.
]


.pull-right[
.center[

![](slides_files/figure-html/normal-scale-1.png)&lt;!-- --&gt;
]]

---

## Model fitting

.pull-left[

* We have chosen a statistical model for our data

* This model has two free parameters, `\(\mu\)` and `\(\sigma\)`

* Which value should we choose for these two parameters?

* Finding good values for parameters of a statistical model means
  **fitting a model to the data**.
]


.pull-right[
.center[

![](slides_files/figure-html/fitting-normal-1.png)&lt;!-- --&gt;

]
]



## Model fitting

.pull-left[

* We fit statistical models by **estimating** the value of parameters,
  given the data observed.

* There are many ways to do that. For one of the fitting methods we will
  use in this course, the estimates for fitting a normal distribution are:
  
  * The sample mean as an estimate for `\(\mu\)`
  * The sample standard deviation as an estimate for `\(\sigma\)`

]

.pull-right[
.center[

![](slides_files/figure-html/fitting-normal_right_one-1.png)&lt;!-- --&gt;

]
]


---

## Some notation


* Our model: mean thorax length `\(x\)` follows a normal distribution:

$$ x \, \sim \, \text{Normal}(\mu, \sigma)$$

--

* The estimate of the parameter `\(\mu\)` is the mean of the values of `\(x\)` in the sample:

$$ \widehat{\mu} \, = \, \bar{x} \, = \, \frac{1}{N} \, \sum_{i=1}^N x_i $$


---


## Some notation



* The estimate of the parameter `\(\sigma\)` is the square root of the variance of the values of `\(x\)` in the sample:

$$ \widehat{\sigma} \, = \, \sqrt{s^2} $$

* Where the variance is the mean of the squared deviation from the sample mean:

$$ s^2 \, = \, \frac{1}{N} \, \sum_{i=1}^N (x_i - \bar{x})^2 $$ 

---

## Other probability distributions

.pull-left[
 
* The normal distribution is widely used, but other distributions
   suit different random variables better. There are many models to choose.
* Choosing a probability distribution to describe a given dataset means
   **making a hypothesis on how your data is generated**.
* For instance, take the number of kids assigned to male gender in 
   families of 12 children in Saxony in the XIX century (Geissller, 1889 *apud* Lindsey, 1995, Introductory Statistics).
]

.pull-right[
.center[
![](slides_files/figure-html/saxony-data-1.png)&lt;!-- --&gt;
]


]

---

## A simple model for this data

.pull-left[

1. Each family is an '*essay*' or an '*experiment*' with 12 '*trials*'; 
2. Each trial (a birth) has only two possible outcomes: male or female gender attributed to the newborn;
3. Trials are independent: the gender of one newborn does not affect the gender for the next births in the family;
4. The probability of each outcome at each trial is constant.
5. These assumptions holds for the **binomial probability distribution**

]

.pull-right[
.center[

![](slides_files/figure-html/unnamed-chunk-11-1.png)&lt;!-- --&gt;

]
]

---

## The binomial probability distribution

.pull-left[

* Assigns a probability for discrete values (real numbers, like counts):
`$$f(x) = {N\choose x} p^x (1 - p)^{N - x}$$`
  * `\(N\)` : number of trials in each experiment
  * `\(p\)` : probability of 'success' in each trial
* `\(N\)` is usually known. To fit a binomial distribution we need only to estimate `\(p\)`
]


.pull-right[
.center[

![](slides_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;

]]

---

## Fitting a binomial distribution to data

.pull-left[

* A good estimator of `\(p\)` is the observed proportion of successes
  among all trials. 
* In our example there was 38100 
  children assigned to male gender among a total of 73380 births, 
  or an observed proportion of 0.519 males.
* Red dots show the probabilities assigned by the binomial with this
  estimate, which suggests a gender bias towards males.

]

.pull-right[
.center[

![](slides_files/figure-html/unnamed-chunk-13-1.png)&lt;!-- --&gt;

]
]

---

## Some other distributions

### Discrete

* **Poisson**: count data of independent events at a constant rate (e.g. number of captures of animals in traps)
* **Negative binomial**: the same, for aggregated events (e.g. number of trees of a given species in forest plots)
* **Geometric**: number of trials before an event with constant rate happens (e.g. number of years of life)


---

## Some other distributions

### Continuous

* **Log-normal**: multiplication of many random variables (e.g. population sizes in birth-death dynamics)
* **Exponential**: continuous time up to an event at constant rate (e.g. failure times of machines, life-spans)
* **Gamma**, **Weibull** : same as exponential, but event rate as a function of time (e.g. life spans with aging)
* **Uniform**: equiprobable values (useful as a null model or to generate other distributions)

---


## Many distributions are related

.center[

&lt;img src="distrib_relationships.png" width="70%" /&gt;
]

.right[
Bolker,2008
See also (http://www.johndcook.com/distribution_chart.html)
]

---

## Take-home messages

1. Probability distributions assign
   probabilities to each possible value of a measurement.

--

2. As such, probability distributions can be conceived as models of
   the process that generates the data at hand.

--

3. We fit a statistical model by finding sensible values for the
   parameters of probability distributions.

---

## References

+ Bolker, B.M. 2008 Ecological Models and Data in R. Princeton:
    Princeton University Press.

+ Gotelli, N.J., Ellison, A.M., Ellison, S.E., 2004. A Primer of
  Ecological Statistics. Sinauer Associates Publishers.

+ McElreath, R., 2018. Statistical Rethinking: A Bayesian Course with
  Examples in R and Stan, 2nd ed. CRC Press.


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
